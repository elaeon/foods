{% extends "busqueda.html" %}
{% load staticfiles %}

{% block contenido_base %}
<div class="container">
<div class="starter-template">
<form>
<table>
<tr>
<th>Receta</th>
<th>Peso(g)</th>
</tr>
{{ formset.management_form }}
{% for form in formset %}
<tr>
<td style="padding:2px;">
{{ form.name }}
</td>
<td>{{ form.recipe }}{{ form.weight }}</td>
{% endfor %}
</table>
</form>

<br>
<!--<div id="barContainer"></div>-->

<div class="panel panel-default">
<div class="panel-heading list-group-item">
    <span class="badge">{{ menu.score }}</span>
    <p class="panel-title">Resultados de Men√∫</p>
</div>
<div class="panel-body">
    <p>Energia: {{ menu.energy.0 }}{{ menu.energy.1 }}</p>
    <p>Radio Omega: {{ menu.radio_omega }}:1</p>
    <p>Peso: {{ menu.weight }}g</p>
</div>
</div>

<div class="panel panel-default">
<div class="panel-heading list-group-item">
<p class="panel-title">Principales nutrientes</p>
</div>
<div class="panel-body">
<table class="table table-striped table-hover table-condensed">
<thead style="font-size: 90%">
<th>Nutriente</th>
<th>Porcentaje</th>
</thead>
<tbody>
{% for porcentaje, nutrdesc in menu.merged_recipes.principals_nutrients %}
<tr>
<td>{{ nutrdesc }}</td>
<td>{{ porcentaje }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
</div>

<h3>Resumen de nutrientes que debes de checar.</h3>
<table class="table table-striped table-hover table-condensed">
<thead style="font-size: 90%">
<th>Nutriente</th>
<th>Porcentaje cubierto</th>
</thead>
<tbody>
{% for _, nutr, score in menu.resume_intake %}
<tr>
{% if score < 50 %}
<td><span style="color: #a00;">{{ nutr }}</span></td>
{% else %}
<td>{{ nutr }}</td>
{% endif %}
<td>{{ score }}</td>
<td>
</td>
</tr>
{% endfor %}
</tbody>
</table>

<h3>Recomendaciones</h3>
<ol>
{% for _, food_name in menu.best %}
<li><a href="{% url 'view_food' food_name.attr.0 %}">{{ food_name.attr.1 }}</a></li>
{% endfor %}
</ol>

</div>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript" src="{% static 'd3.js' %}"></script>
<script type="text/javascript" src="{% static 'dimple.v2.1.2.min.js' %}"></script>
<script type="text/javascript">
var principals = [];

var svg = dimple.newSvg("#barContainer", 1100, 210);
var barChart = new dimple.chart(svg, principals);
barChart.setBounds(10, 30, 950, 130)
barChart.addPctAxis("x", "porcentaje");
barChart.addCategoryAxis("y", "tipo");
var barSeries = barChart.addSeries("nombre", dimple.plot.bar);
barSeries.stacked = true;
barChart.addLegend(10, 10, 1100, 30, "right");
barChart.draw();
</script>
{% endblock %}
