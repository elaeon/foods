{% extends "busqueda.html" %}
{% load staticfiles %}

{% block contenido_base %}
<div class="container">
<div class="starter-template">
<div class="row">
<form action="." method="POST">
{% csrf_token %}
<table>
{% for food in foods %}
<tr>
<td style="padding:2px;">
<a href="{% url 'view_food' food.ndb_no %}">{{ food.name }}</a>
</td>
<td>{{ food.radio }}</td>
<td><button name="analizar" value="{{ food.ndb_no }}">mejorar</button></td>
{% endfor %}
</table>
</form>

<div id="chartContainer"></div>

<div id="text-chart">
	<div id="chart1"></div>
</div>
</div>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript" src="{% static 'd3.js' %}"></script>
<script type="text/javascript" src="{% static 'dimple.v2.1.2.min.js' %}"></script>
<script type="text/javascript">
var data = [];
{% for nutrient, value in total_food %}
data.push({nombre: '{{ nutrient }}', valor: {{ value }}, type: "foods"})
{% endfor %}

var svg = dimple.newSvg("#chartContainer", 900, 600);
var myChart = new dimple.chart(svg, data);
myChart.assignColor("foods", "#0066ff", null, .5);

myChart.setBounds(60, 30, 750, 305);
var x = myChart.addCategoryAxis("x", "nombre");
x.showGridlines = true;
var y = myChart.addMeasureAxis("y", "valor");
y.showGridlines = false;
var l = myChart.addSeries("tipo", dimple.plot.line);
l.stacked = false;
x.addOrderRule("nombre");

l.interpolation = "step";
myChart.addLegend(900, 100, 60, 300, "right");
y.useLog = true;
y.logBase = 10;
myChart.draw();
x.titleShape.text("Nutriente");
y.tickFormat = ',.2f';
</script>
{% endblock %}
